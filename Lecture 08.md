---


---

<h1 id="тут-какое-то-говно-сори">ТУТ КАКОЕ ТО ГОВНО, СОРИ</h1>
<h3 id="еще-о-вариадиках">Еще о вариадиках</h3>
<pre class=" language-cpp"><code class="prism  language-cpp"><span class="token keyword">void</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">bind</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 			 <span class="token comment">//f(1, 2, 3)</span>
<span class="token function">bind</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> _1<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 			 <span class="token comment">//f(4, 6, 5)</span>
<span class="token function">bind</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> _3<span class="token punctuation">,</span> _2<span class="token punctuation">,</span> _1<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//f(9, 8, 7)</span>
<span class="token function">bind</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> _2<span class="token punctuation">,</span> _2<span class="token punctuation">,</span> _3<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//f(11, 11, 12)</span>

<span class="token function">bind</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token function">bind</span><span class="token punctuation">(</span>g<span class="token punctuation">,</span> _2<span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">43</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">44</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//f(44, g(45, 42), 43)</span>
</code></pre>
<p>Идея<br>
Пусть <code>f</code> принимает <code>n</code> аргументов, <code>bind</code>вызываем с <code>k</code> аргументами</p>
<pre class=" language-cpp"><code class="prism  language-cpp"><span class="token function">f</span><span class="token punctuation">(</span><span class="token function">g1</span><span class="token punctuation">(</span>a1<span class="token punctuation">,</span> a2<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span> ak<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token function">gn</span><span class="token punctuation">(</span>a1<span class="token punctuation">,</span> a2<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span> ak<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">bind</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span> назовем <span class="token function">bind</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> b1<span class="token punctuation">,</span> b2<span class="token punctuation">,</span> b3<span class="token punctuation">)</span><span class="token punctuation">(</span>a1<span class="token punctuation">,</span> a2<span class="token punctuation">,</span> a3<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> F<span class="token punctuation">,</span> <span class="token keyword">typename</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> Bs<span class="token operator">&gt;</span>
bind_f <span class="token operator">&lt;</span>F<span class="token punctuation">,</span> Bs <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">&gt;</span> <span class="token function">bind</span><span class="token punctuation">(</span>F f<span class="token punctuation">,</span> Bs <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> bs<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> bind_f<span class="token operator">&lt;</span>F<span class="token punctuation">,</span> BS <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token function">move</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">move</span><span class="token punctuation">(</span>bs<span class="token punctuation">)</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> T<span class="token operator">&gt;</span>
<span class="token keyword">struct</span> G <span class="token punctuation">{</span>
	<span class="token function">G</span><span class="token punctuation">(</span>T value<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">value</span><span class="token punctuation">(</span><span class="token function">move</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
	
	<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> As<span class="token operator">&gt;</span>
	T <span class="token function">opetator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span>As <span class="token keyword">const</span><span class="token operator">&amp;</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> as<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> value<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

<span class="token keyword">private</span><span class="token operator">:</span>
	T value<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">template</span> <span class="token operator">&lt;</span>size_t N<span class="token operator">&gt;</span>
<span class="token keyword">struct</span> G<span class="token operator">&lt;</span>placeholder<span class="token operator">&lt;</span>N<span class="token operator">&gt;&gt;</span> <span class="token punctuation">{</span>
	<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> A<span class="token punctuation">,</span> <span class="token keyword">typename</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> As<span class="token operator">&gt;</span>
	<span class="token keyword">auto</span> <span class="token keyword">operator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span>A <span class="token keyword">const</span><span class="token operator">&amp;</span> a0<span class="token punctuation">,</span> As <span class="token keyword">const</span><span class="token operator">&amp;</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> as<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> G<span class="token operator">&lt;</span>N <span class="token operator">-</span> <span class="token number">1</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span>As<span class="token punctuation">)</span><span class="token punctuation">;</span>	
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token operator">&gt;</span>
<span class="token keyword">struct</span> G<span class="token operator">&lt;</span>placeholder<span class="token operator">&lt;</span><span class="token number">0</span><span class="token operator">&gt;&gt;</span> <span class="token punctuation">{</span>
	<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> A<span class="token punctuation">,</span> <span class="token keyword">typename</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> As<span class="token operator">&gt;</span>
	A <span class="token keyword">operator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span>A <span class="token keyword">const</span><span class="token operator">&amp;</span> a<span class="token punctuation">,</span> As <span class="token keyword">const</span><span class="token operator">&amp;</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> as<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> a<span class="token punctuation">;</span>	
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">template</span><span class="token operator">&lt;</span>size_t <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> Indices<span class="token operator">&gt;</span>
<span class="token keyword">struct</span> index_tuple <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">template</span><span class="token operator">&lt;</span>size_t N<span class="token punctuation">,</span> size_t <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> Indices<span class="token operator">&gt;</span>
<span class="token keyword">struct</span> make_index_tuple <span class="token punctuation">{</span>
	<span class="token keyword">typedef</span> make_index_tuple<span class="token operator">&lt;</span>N <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> N <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> Indices <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">&gt;</span><span class="token operator">::</span>type type<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">template</span> <span class="token operator">&lt;</span>size_t <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> Indices<span class="token operator">&gt;</span>
<span class="token keyword">struct</span> make_index_tuple<span class="token operator">&lt;</span><span class="token number">0</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
	<span class="token keyword">typedef</span> index_tuple<span class="token operator">&lt;</span>Indeces <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">&gt;</span> type<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> F<span class="token punctuation">,</span> <span class="token keyword">typename</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> Bs<span class="token operator">&gt;</span>
<span class="token keyword">struct</span> bind_f <span class="token punctuation">{</span>
	<span class="token function">bind_f</span><span class="token punctuation">(</span>F f<span class="token punctuation">,</span> Bs <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> bs<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token function">move</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">gs</span><span class="token punctuation">(</span><span class="token function">move</span><span class="token punctuation">(</span>bs<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
	<span class="token keyword">auto</span> <span class="token function">call</span><span class="token punctuation">(</span>index_tuple<span class="token operator">&lt;</span>Indices<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> As <span class="token keyword">const</span><span class="token operator">&amp;</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> as<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token function">f</span><span class="token punctuation">(</span>get<span class="token operator">&lt;</span>Indices<span class="token operator">&gt;</span><span class="token punctuation">(</span>gs<span class="token punctuation">)</span><span class="token punctuation">(</span>as <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">auto</span> <span class="token keyword">operator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span>As <span class="token keyword">const</span><span class="token operator">&amp;</span> as<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token function">call</span><span class="token punctuation">(</span>make_index_tuple<span class="token operator">&lt;</span><span class="token keyword">sizeof</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">(</span>Bs<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> as<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token keyword">private</span><span class="token operator">:</span>
	F f<span class="token punctuation">;</span>
	tuple<span class="token operator">&lt;</span>G<span class="token operator">&lt;</span>BS<span class="token operator">&gt;</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">&gt;</span> gs<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p><strong>TODO</strong></p>

